"use strict";(self.webpackChunkwenjuan_fe=self.webpackChunkwenjuan_fe||[]).push([[166],{47810:(e,n,s)=>{s.r(n),s.d(n,{default:()=>qe});var i=s(65043),t=s(79456),c=s(80788),l=s(7679),r=s(42522),d=s(48371),o=s(73216),a=s(89280),x=s(85578),j=s(6051),p=s(87021),u=s(51118),A=s(67407),h=s(40164),_=s(682),m=s(26998),f=s(76094),v=s(58796),y=s(96651),C=s(61966),E=s(82692),g=s(98617),k=s(9025),w=s(7047),N=s(45591),b=s(28369),I=s(55574),L=s(42144),T=s(28419),P=s(63393),S=s(70579);const K=()=>{const e=(0,t.wA)(),{selectedId:n,componentList:s,selectedComponent:i,copiedComponent:c}=(0,P.A)(),{isLocked:r}=i||{},d=s.length,o=s.findIndex((e=>e.fe_id===n)),a=o<=0,x=o+1>=d;return(0,S.jsxs)(j.A,{children:[(0,S.jsx)(y.A,{title:"\u5220\u9664",children:(0,S.jsx)(p.Ay,{shape:"circle",icon:(0,S.jsx)(C.A,{}),onClick:function(){e((0,l.Tg)())}})}),(0,S.jsx)(y.A,{title:"\u9690\u85cf",children:(0,S.jsx)(p.Ay,{shape:"circle",icon:(0,S.jsx)(E.A,{}),onClick:function(){e((0,l.CK)({fe_id:n,isHidden:!0}))}})}),(0,S.jsx)(y.A,{title:"\u9501\u5b9a",children:(0,S.jsx)(p.Ay,{shape:"circle",icon:(0,S.jsx)(g.A,{}),onClick:function(){e((0,l.ON)({fe_id:n}))},type:r?"primary":"default"})}),(0,S.jsx)(y.A,{title:"\u590d\u5236",children:(0,S.jsx)(p.Ay,{shape:"circle",icon:(0,S.jsx)(k.A,{}),onClick:function(){e((0,l.Sk)())}})}),(0,S.jsx)(y.A,{title:"\u7c98\u8d34",children:(0,S.jsx)(p.Ay,{shape:"circle",icon:(0,S.jsx)(w.A,{}),onClick:function(){e((0,l.F7)())},disabled:null==c})}),(0,S.jsx)(y.A,{title:"\u4e0a\u79fb",children:(0,S.jsx)(p.Ay,{shape:"circle",icon:(0,S.jsx)(N.A,{}),onClick:function(){a||e((0,l.pp)({oldIndex:o,newIndex:o-1}))},disabled:a})}),(0,S.jsx)(y.A,{title:"\u4e0b\u79fb",children:(0,S.jsx)(p.Ay,{shape:"circle",icon:(0,S.jsx)(b.A,{}),onClick:function(){x||e((0,l.pp)({oldIndex:o,newIndex:o+1}))},disabled:x})}),(0,S.jsx)(y.A,{title:"\u64a4\u9500",children:(0,S.jsx)(p.Ay,{shape:"circle",icon:(0,S.jsx)(I.A,{}),onClick:function(){e(T.IE.undo())}})}),(0,S.jsx)(y.A,{title:"\u91cd\u505a",children:(0,S.jsx)(p.Ay,{shape:"circle",icon:(0,S.jsx)(L.A,{}),onClick:function(){e(T.IE.redo())}})})]})};var H=s(41361),z=s(36823);const R="EditHeader_header-wrapper__hadib",Y="EditHeader_header__1w-EQ",D="EditHeader_left__E8dfx",F="EditHeader_main__KJWP2",O="EditHeader_right__tgI14",{Title:q}=a.A,G=()=>{const{title:e}=(0,d.A)(),n=(0,t.wA)(),[s,c]=(0,i.useState)(!1);return s?(0,S.jsx)(x.A,{value:e,onChange:function(e){const s=e.target.value.trim();s&&n((0,H.I5)(s))},onPressEnter:()=>c(!1),onBlur:()=>c(!1)}):(0,S.jsxs)(j.A,{children:[(0,S.jsx)(q,{children:e}),(0,S.jsx)(p.Ay,{icon:(0,S.jsx)(A.A,{}),type:"text",onClick:()=>c(!0)})]})},M=()=>{const{id:e}=(0,o.g)(),{componentList:n=[]}=(0,P.A)(),s=(0,d.A)(),{loading:i,run:t}=(0,m.A)((async()=>{e&&await(0,z.Tg)(e,{...s,componentList:n})}),{manual:!0});return(0,f.A)(["ctrl.s","meta.s"],(e=>{e.preventDefault(),i||t()})),(0,v.A)((()=>{t()}),[n,s],{wait:1e3}),(0,S.jsx)(p.Ay,{onClick:t,disabled:i,icon:i?(0,S.jsx)(h.A,{}):null,children:"\u4fdd\u5b58"})},J=()=>{const e=(0,o.Zp)(),{id:n}=(0,o.g)(),{componentList:s=[]}=(0,P.A)(),i=(0,d.A)(),{loading:t,run:c}=(0,m.A)((async()=>{n&&await(0,z.Tg)(n,{...i,componentList:s,isPublished:!0})}),{manual:!0,onSuccess(){u.Ay.success("\u53d1\u5e03\u6210\u529f"),e("/question/stat/"+n)}});return(0,S.jsx)(p.Ay,{type:"primary",onClick:c,disabled:t,children:"\u53d1\u5e03"})},V=()=>{const e=(0,o.Zp)();return(0,S.jsx)("div",{className:R,children:(0,S.jsxs)("div",{className:Y,children:[(0,S.jsx)("div",{className:D,children:(0,S.jsxs)(j.A,{children:[(0,S.jsx)(p.Ay,{type:"link",icon:(0,S.jsx)(_.A,{}),onClick:()=>e(-1),children:"\u8fd4\u56de"}),(0,S.jsx)(G,{})]})}),(0,S.jsx)("div",{className:F,children:(0,S.jsx)(K,{})}),(0,S.jsx)("div",{className:O,children:(0,S.jsxs)(j.A,{children:[(0,S.jsx)(M,{}),(0,S.jsx)(J,{})]})})]})})};var B=s(42919),Q=s(98139),W=s.n(Q),Z=s(82925);function U(){const e=document.activeElement;return e===document.body||!(null===e||void 0===e||!e.matches('div[role="button"]'))}const X=function(){const e=(0,t.wA)();(0,f.A)(["backspace","delete"],(()=>{U()&&e((0,l.Tg)())})),(0,f.A)(["ctrl.c","meta.c"],(()=>{U()&&e((0,l.Sk)())})),(0,f.A)(["ctrl.v","meta.v"],(()=>{U()&&e((0,l.F7)())})),(0,f.A)("uparrow",(()=>{U()&&e((0,l.p5)())})),(0,f.A)("downarrow",(()=>{U()&&e((0,l.t$)())})),(0,f.A)(["ctrl.z","meta.z"],(()=>{U()&&e(T.IE.undo())}),{exactMatch:!0}),(0,f.A)(["ctrl.shift.z","meta.shift.z"],(()=>{U()&&e(T.IE.redo())}))};var $=s(23585),ee=s(1648);const ne=e=>{const{children:n,items:s,onDragEnd:i}=e,t=(0,$.FR)((0,$.MS)($.cA,{activationConstraint:{distance:8}}));return(0,S.jsx)($.Mp,{sensors:t,collisionDetection:$.fp,onDragEnd:function(e){const{active:n,over:t}=e;if(null!=t&&n.id!==t.id){const e=s.findIndex((e=>e.fe_id===n.id)),c=s.findIndex((e=>e.fe_id===t.id));i(e,c)}},children:(0,S.jsx)(ee.gB,{items:s,strategy:ee._G,children:n})})};var se=s(41024);const ie=e=>{let{id:n,children:s}=e;const{attributes:i,listeners:t,setNodeRef:c,transform:l,transition:r}=(0,ee.gl)({id:n}),d={transform:se.Ks.Transform.toString(l),transition:r,cursor:"pointer"};return(0,S.jsx)("div",{ref:c,style:d,...i,...t,children:s})},te="EditCanvas_canvas__cazQA",ce="EditCanvas_component-wrapper__DsHYx",le="EditCanvas_selected__H31gS",re="EditCanvas_locked__qbDcd",de="EditCanvas_component__8IYr3";function oe(e){const{type:n,props:s}=e,i=(0,Z.T)(n);if(null==i)return null;const{Component:t}=i;return(0,S.jsx)(t,{...s})}const ae=e=>{let{loading:n}=e;const{componentList:s,selectedId:i}=(0,P.A)(),c=(0,t.wA)();if(X(),n)return(0,S.jsx)("div",{style:{textAlign:"center",marginTop:"24px"},children:(0,S.jsx)(B.A,{})});const r=s.map((e=>({...e,id:e.fe_id})));return(0,S.jsx)(ne,{items:r,onDragEnd:function(e,n){c((0,l.pp)({oldIndex:e,newIndex:n}))},children:(0,S.jsx)("div",{className:te,children:s.filter((e=>!e.isHidden)).map((e=>{const{fe_id:n,isLocked:s}=e,t=ce,r=le,d=re,o=W()({[t]:!0,[r]:n===i,[d]:s});return(0,S.jsx)(ie,{id:n,children:(0,S.jsx)("div",{className:o,onClick:e=>{return s=n,e.stopPropagation(),void c((0,l.RC)(s));var s},children:(0,S.jsx)("div",{className:de,children:oe(e)})})},n)}))})})};var xe=s(29437),je=s(74563),pe=s(37644),ue=s(19452);const Ae="ComponentLib_wrapper__1kUNe",he="ComponentLib_component__Ghpyr",{Title:_e}=a.A,me=()=>{const e=(0,t.wA)();return(0,S.jsx)(S.Fragment,{children:Z.j.map(((n,s)=>{const{groupId:i,groupName:t,components:c}=n;return(0,S.jsxs)("div",{children:[(0,S.jsx)(_e,{level:3,style:{fontSize:"16px",marginTop:s>0?"20px":"0"},children:t}),(0,S.jsx)("div",{children:c.map((n=>function(e,n){const{title:s,type:i,Component:t,defaultProps:c}=e;return(0,S.jsx)("div",{className:Ae,onClick:()=>{n((0,l.X8)({fe_id:(0,ue.Ak)(),title:s,type:i,props:c}))},children:(0,S.jsx)("div",{className:he,children:(0,S.jsx)(t,{})})},i)}(n,e)))})]},i)}))})},fe="Layers_wrapper__Ngo9t",ve="Layers_title__k+dnT",ye="Layers_selected__AwpYh",Ce="Layers_handler__OzxxH",Ee="Layers_btn__StJby",ge=()=>{const{componentList:e,selectedId:n}=(0,P.A)(),s=(0,t.wA)(),[c,r]=(0,i.useState)("");function d(e){const i=e.target.value.trim();i&&n&&s((0,l.oA)({fe_id:n,title:i}))}const o=e.map((e=>({...e,id:e.fe_id})));return(0,S.jsx)(ne,{items:o,onDragEnd:function(e,n){s((0,l.pp)({oldIndex:e,newIndex:n}))},children:e.map((i=>{const{fe_id:t,title:o,isHidden:a,isLocked:A}=i,h=ve,_=ye,m=W()({[h]:!0,[_]:t===n});return(0,S.jsx)(ie,{id:t,children:(0,S.jsxs)("div",{className:fe,children:[(0,S.jsxs)("div",{className:m,onClick:()=>function(i){const t=e.find((e=>e.fe_id===i));if(!t||!t.isHidden)return i!==n?(s((0,l.RC)(i)),void r("")):void r(i);u.Ay.info("\u4e0d\u80fd\u9009\u4e2d\u9690\u85cf\u7684\u7ec4\u4ef6")}(t),children:[t===c&&(0,S.jsx)(x.A,{value:o,onChange:d,onPressEnter:()=>r(""),onBlur:()=>r("")}),t!==c&&o]}),(0,S.jsx)("div",{className:Ce,children:(0,S.jsxs)(j.A,{children:[(0,S.jsx)(p.Ay,{size:"small",shape:"circle",className:a?"":Ee,icon:(0,S.jsx)(E.A,{}),type:a?"primary":"text",onClick:()=>function(e,n){s((0,l.CK)({fe_id:e,isHidden:n}))}(t,!a)}),(0,S.jsx)(p.Ay,{size:"small",shape:"circle",className:A?"":Ee,icon:(0,S.jsx)(g.A,{}),type:A?"primary":"text",onClick:()=>function(e){s((0,l.ON)({fe_id:e}))}(t)})]})})]})},t)}))})},ke=()=>{const e=[{key:"componentLib",label:(0,S.jsxs)("span",{children:[(0,S.jsx)(je.A,{}),"\u7ec4\u4ef6\u5e93"]}),children:(0,S.jsx)(me,{})},{key:"layers",label:(0,S.jsxs)("span",{children:[(0,S.jsx)(pe.A,{}),"\u56fe\u5c42"]}),children:(0,S.jsx)(ge,{})}];return(0,S.jsx)(xe.A,{defaultActiveKey:"componentLib",items:e})};var we=s(36091),Ne=s(14524);const be=()=>(0,S.jsx)("div",{style:{textAlign:"center"},children:"\u672a\u9009\u4e2d\u7ec4\u4ef6"}),Ie=()=>{const e=(0,t.wA)(),{selectedComponent:n}=(0,P.A)();if(null==n)return(0,S.jsx)(be,{});const{type:s,props:i,isLocked:c,isHidden:r}=n,d=(0,Z.T)(s);if(null==d)return(0,S.jsx)(be,{});const{PropComponent:o}=d;return(0,S.jsx)(o,{...i,onChange:function(s){if(null==n)return;const{fe_id:i}=n;e((0,l.Kb)({fe_id:i,newProps:s}))},disabled:c||r})};var Le=s(57469);const{TextArea:Te}=x.A,Pe=()=>{const e=(0,d.A)(),[n]=Le.A.useForm(),s=(0,t.wA)();return(0,i.useEffect)((()=>{n.setFieldsValue(e)}),[e]),(0,S.jsxs)(Le.A,{layout:"vertical",initialValues:e,onValuesChange:function(){s((0,H.nq)(n.getFieldsValue()))},form:n,children:[(0,S.jsx)(Le.A.Item,{label:"\u95ee\u5377\u6807\u9898",name:"title",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6807\u9898"}],children:(0,S.jsx)(x.A,{placeholder:"\u8bf7\u8f93\u5165\u6807\u9898"})}),(0,S.jsx)(Le.A.Item,{label:"\u95ee\u5377\u63cf\u8ff0",name:"desc",children:(0,S.jsx)(Te,{placeholder:"\u95ee\u5377\u63cf\u8ff0..."})}),(0,S.jsx)(Le.A.Item,{label:"\u6837\u5f0f\u4ee3\u7801",name:"css",children:(0,S.jsx)(Te,{placeholder:"\u8f93\u5165 CSS \u6837\u5f0f\u4ee3\u7801..."})}),(0,S.jsx)(Le.A.Item,{label:"\u811a\u672c\u4ee3\u7801",name:"js",children:(0,S.jsx)(Te,{placeholder:"\u8f93\u5165 JS \u811a\u672c\u4ee3\u7801..."})})]})};var Se=function(e){return e.PROP_KEY="prop",e.SETTING_KEY="setting",e}(Se||{});const Ke=()=>{const[e,n]=(0,i.useState)(Se.PROP_KEY),{selectedId:s}=(0,P.A)();(0,i.useEffect)((()=>{n(s?Se.PROP_KEY:Se.SETTING_KEY)}),[s]);const t=[{key:Se.PROP_KEY,label:(0,S.jsxs)("span",{children:[(0,S.jsx)(we.A,{}),"\u5c5e\u6027"]}),children:(0,S.jsx)(Ie,{})},{key:Se.SETTING_KEY,label:(0,S.jsxs)("span",{children:[(0,S.jsx)(Ne.A,{}),"\u9875\u9762\u8bbe\u7f6e"]}),children:(0,S.jsx)(Pe,{})}];return(0,S.jsx)(xe.A,{activeKey:e,items:t})},He="Edit_container__bi3-2",ze="Edit_content-wrapper__JM839",Re="Edit_content__zPwhR",Ye="Edit_left__svytE",De="Edit_main__Sqyol",Fe="Edit_canvas-wrapper__-h80W",Oe="Edit_right__MNPKz",qe=()=>{const e=(0,t.wA)(),{loading:n}=(0,r.A)();const{title:s}=(0,d.A)();return(0,c.A)("\u95ee\u5377\u7f16\u8f91 - ".concat(s)),(0,S.jsxs)("div",{className:He,children:[(0,S.jsx)(V,{}),(0,S.jsx)("div",{className:ze,children:(0,S.jsxs)("div",{className:Re,children:[(0,S.jsx)("div",{className:Ye,children:(0,S.jsx)(ke,{})}),(0,S.jsx)("div",{className:De,onClick:function(){e((0,l.RC)(""))},children:(0,S.jsx)("div",{className:Fe,children:(0,S.jsx)(ae,{loading:n})})}),(0,S.jsx)("div",{className:Oe,children:(0,S.jsx)(Ke,{})})]})})]})}}}]);
//# sourceMappingURL=editPage.1546290a.chunk.js.map